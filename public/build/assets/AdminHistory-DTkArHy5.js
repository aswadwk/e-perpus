import{r as l,W as x,j as e,Y as g}from"./app-yMZrsqwC.js";import{D as S}from"./DefaultLayout-C2_q1QE6.js";import{S as w}from"./SelectInput-BufbXwGQ.js";import{S as D}from"./Sheet-C6jorPKo.js";import{B as b}from"./button-DoUDRYi7.js";import{C as B,a as _,b as C,e as v,c as y}from"./card-EMH6NASV.js";import{l as T,T as N,a as H,b as p,c as s,d as P,e as t}from"./lodash-B5H2LnEO.js";import{r as E,t as h,d as R,a as U}from"./utils-D0Y_8jrY.js";import{J as j}from"./index-NjrTV968.js";import{S as M}from"./square-pen-DZFpRoEh.js";import"./index-x4fCwDdj.js";import"./index-hnFnuZ5j.js";import"./ThemeProvider-C4ksScWi.js";import"./dialog-DHL9gay8.js";import"./popover-DFGZXV4t.js";import"./label-CqT395K3.js";function A(r){switch(r){case"pending":return"Menunggu";case"borrowed":return"Dipinjam";case"returned":return"Dikembalikan";case"rejected":return"Ditolak";default:return r}}const se=({histories:r})=>{var m;const[o,u]=l.useState({per_page:10,start_date:"",end_date:"",search:"",subscription:"",with_trashed:!1}),[i,d]=l.useState({borrowBook:!1}),n=x({status:"",id:"",return_date_actual:""});x({});const c=l.useRef(!0),f=l.useRef(T.debounce(a=>{E({...a,start_date:h(a.start_date,""),end_date:h(a.end_date,"")})},500)).current;l.useEffect(()=>{if(c.current){c.current=!1;return}f(o)},[o]);async function k(){console.log(n.data),n.post(route("web.histories.update",n.data.id),{preserveState:!0,onSuccess:()=>{n.reset(),j.success("Book status updated successfully"),d({...i,borrowBook:!1})},onError:()=>{j.error("Failed to update book status")}})}return e.jsxs(S,{children:[e.jsx(g,{title:"Publisher"}),e.jsx(D,{isOpen:i.borrowBook,onClose:()=>{d({...i,borrowBook:!1})},width:"w-[600px] sm:w-[840px]",title:"Ubah Status Peminjaman Buku",description:"Ubah status peminjaman buku",children:e.jsx(O,{form:n,onSubmit:k})}),e.jsxs(B,{className:"w-full mx-auto",children:[e.jsxs(_,{children:[e.jsx(C,{children:"Histori Peminjaman Buku"}),e.jsx(v,{children:"Daftar pemijaman buku yang pernah dilakukan oleh pengguna"})]}),e.jsx(y,{children:e.jsxs(N,{children:[e.jsx(H,{children:e.jsxs(p,{children:[e.jsx(s,{children:"Peminjam"}),e.jsx(s,{children:"Judul"}),e.jsx(s,{children:"Author"}),e.jsx(s,{children:"Tanggal Pinjam"}),e.jsx(s,{children:"Tanggal Balik"}),e.jsx(s,{children:"Status"}),e.jsx(s,{children:"Aksi"})]})}),e.jsx(P,{children:(m=r.data)==null?void 0:m.map(a=>e.jsxs(p,{children:[e.jsxs(t,{className:"font-medium",children:[a.user.name,e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-500",children:a.user.email})]}),e.jsx(t,{className:"font-medium",children:a.book.title}),e.jsx(t,{children:a.book.author}),e.jsxs(t,{children:[R(a.created_at),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-500",children:U(a.created_at)})]}),e.jsx(t,{children:a.return_date}),e.jsx(t,{children:A(a.status)}),e.jsx(t,{children:e.jsx(b,{variant:"ghost",onClick:()=>{n.setData("id",a.id),d({...i,borrowBook:!0})},children:e.jsx(M,{size:16})})})]},a.id))})]})})]})]})},J=[{value:"pending",label:"Pending"},{value:"borrowed",label:"Dipinjam"},{value:"returned",label:"Dikembalikan"},{value:"rejected",label:"Ditolak"}];function O({onSubmit:r,form:o}){return e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"flex flex-col gap-3 mb-4",children:e.jsx("div",{className:"flex flex-col gap-2 ",children:e.jsx(w,{onChange:u=>o.setData("status",u),label:"Status",placeholder:"Select status...",items:J,value:o.data.status})})}),e.jsx(b,{onClick:()=>{r()},children:"Update"})]})}export{se as default};
