import{r as l,W as h,j as e,Y as S}from"./app-mwD8rKH0.js";import{D as k}from"./DefaultLayout-y9en6JwO.js";import{S as B}from"./SelectInput-ClwlolNA.js";import{S as _}from"./Sheet-BDsnv9r-.js";import{B as f}from"./button-DM4OJObE.js";import{C,a as v,b as D,e as g,c as y}from"./card-CsNZX89Y.js";import{l as T,T as R,a as H,b as p,c as a,d as E,e as r,S as N}from"./lodash-MX0gHBgf.js";import{r as A,t as m,d as U,a as M}from"./utils-BmcsHCy2.js";import{J as j}from"./index-COBK1RFK.js";import"./index-BwAztNm9.js";import"./index-D_-WwNEz.js";import"./sheet-DRZm5MKN.js";import"./dialog-D7MkpADV.js";import"./popover-Cc93Q8JV.js";import"./label-D-VhJ438.js";const ee=({histories:n})=>{var x;const[o,c]=l.useState({per_page:10,start_date:"",end_date:"",search:"",subscription:"",with_trashed:!1}),[d,i]=l.useState({borrowBook:!1}),s=h({status:"",id:"",return_date_actual:""});h({});const u=l.useRef(!0),b=l.useRef(T.debounce(t=>{A({...t,start_date:m(t.start_date,""),end_date:m(t.end_date,"")})},500)).current;l.useEffect(()=>{if(u.current){u.current=!1;return}b(o)},[o]);async function w(){console.log(s.data),s.post(route("web.histories.update",s.data.id),{preserveState:!0,onSuccess:()=>{s.reset(),j.success("Book status updated successfully"),i({...d,borrowBook:!1})},onError:()=>{j.error("Failed to update book status")}})}return e.jsxs(k,{children:[e.jsx(S,{title:"Publisher"}),e.jsx(_,{isOpen:d.borrowBook,onClose:()=>{i({...d,borrowBook:!1})},width:"w-[600px] sm:w-[840px]",title:"Update Status",description:"Fill in the form below to update the status of the book",children:e.jsx(P,{form:s,onSubmit:w})}),e.jsxs(C,{className:"w-full mx-auto",children:[e.jsxs(v,{children:[e.jsx(D,{children:"Book Borrowing History"}),e.jsx(g,{children:"A list of recent book loans and their current status."})]}),e.jsx(y,{children:e.jsxs(R,{children:[e.jsx(H,{children:e.jsxs(p,{children:[e.jsx(a,{children:"Book Title"}),e.jsx(a,{children:"Author"}),e.jsx(a,{children:"Borrow Date"}),e.jsx(a,{children:"Return Date"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Action"})]})}),e.jsx(E,{children:(x=n.data)==null?void 0:x.map(t=>e.jsxs(p,{children:[e.jsx(r,{className:"font-medium",children:t.book.title}),e.jsx(r,{children:t.book.author}),e.jsxs(r,{children:[U(t.created_at),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-500",children:M(t.created_at)})]}),e.jsx(r,{children:t.return_date}),e.jsx(r,{children:t.status}),e.jsx(r,{children:e.jsx(f,{onClick:()=>{s.setData("id",t.id),i({...d,borrowBook:!0})},children:e.jsx(N,{size:16})})})]},t.id))})]})})]})]})},O=[{value:"pending",label:"Pending"},{value:"borrowed",label:"Borrowed"},{value:"returned",label:"Returned"},{value:"rejected",label:"Rejected"}];function P({onSubmit:n,form:o}){return e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"flex flex-col gap-3 mb-4",children:e.jsx("div",{className:"flex flex-col gap-2 ",children:e.jsx(B,{onChange:c=>o.setData("status",c),label:"Status",placeholder:"Select status...",items:O,value:o.data.status})})}),e.jsx(f,{onClick:()=>{n()},children:"Update"})]})}export{ee as default};
