import{r as i,W as p,j as e,Y as g}from"./app-0XjETWz2.js";import{D as S}from"./DefaultLayout-B2m59dEV.js";import{S as w}from"./SelectInput-ChFBfz9b.js";import{S as D}from"./Sheet-CTWj6mDN.js";import{B as b}from"./button-CoqDk6re.js";import{C as B,a as _,b as C,e as v,c as T}from"./card-7EO7ouYE.js";import{l as y,T as H,a as E,b as h,c as r,d as N,e as o}from"./lodash-BS_soyp0.js";import{r as P,t as x,d as R,a as U}from"./utils-DKab1chf.js";import{J as j}from"./index-CYfGYf1K.js";import{S as M}from"./square-pen-Cj9cZZvZ.js";import"./index-C8eaftlp.js";import"./index-CzlJDc6-.js";import"./ThemeProvider-CXa972W9.js";import"./dialog-D8poKy1m.js";import"./popover-B0GW8B2v.js";import"./label-DDPtsqWJ.js";function A(s){switch(s){case"pending":return"Menunggu";case"borrowed":return"Dipinjam";case"returned":return"Dikembalikan";case"rejected":return"Ditolak";default:return s}}const se=({histories:s})=>{var m;const[n,u]=i.useState({per_page:10,start_date:"",end_date:"",search:"",subscription:"",with_trashed:!1}),[l,d]=i.useState({borrowBook:!1}),t=p({status:"",id:"",return_date_actual:""});p({});const c=i.useRef(!0),f=i.useRef(y.debounce(a=>{P({...a,start_date:x(a.start_date,""),end_date:x(a.end_date,"")})},500)).current;i.useEffect(()=>{if(c.current){c.current=!1;return}f(n)},[n]);async function k(){console.log(t.data),t.post(route("web.histories.update",t.data.id),{preserveState:!0,onSuccess:()=>{t.reset(),j.success("Book status updated successfully"),d({...l,borrowBook:!1})},onError:()=>{j.error("Failed to update book status")}})}return e.jsxs(S,{children:[e.jsx(g,{title:"Publisher"}),e.jsx(D,{isOpen:l.borrowBook,onClose:()=>{d({...l,borrowBook:!1})},width:"w-[600px] sm:w-[840px]",title:"Ubah Status Peminjaman Buku",description:"Ubah status peminjaman buku",children:e.jsx(O,{form:t,onSubmit:k})}),e.jsxs(B,{className:"w-full mx-auto",children:[e.jsxs(_,{children:[e.jsx(C,{children:"Histori Peminjaman Buku"}),e.jsx(v,{children:"Daftar pemijaman buku yang pernah dilakukan oleh pengguna"})]}),e.jsx(T,{children:e.jsxs(H,{children:[e.jsx(E,{children:e.jsxs(h,{children:[e.jsx(r,{children:"Judul"}),e.jsx(r,{children:"Author"}),e.jsx(r,{children:"Tanggal Pinjam"}),e.jsx(r,{children:"Tanggal Balik"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Aksi"})]})}),e.jsx(N,{children:(m=s.data)==null?void 0:m.map(a=>e.jsxs(h,{children:[e.jsx(o,{className:"font-medium",children:a.book.title}),e.jsx(o,{children:a.book.author}),e.jsxs(o,{children:[R(a.created_at),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-500",children:U(a.created_at)})]}),e.jsx(o,{children:a.return_date}),e.jsx(o,{children:A(a.status)}),e.jsx(o,{children:e.jsx(b,{variant:"ghost",onClick:()=>{t.setData("id",a.id),d({...l,borrowBook:!0})},children:e.jsx(M,{size:16})})})]},a.id))})]})})]})]})},J=[{value:"pending",label:"Pending"},{value:"borrowed",label:"Dipinjam"},{value:"returned",label:"Dikembalikan"},{value:"rejected",label:"Ditolak"}];function O({onSubmit:s,form:n}){return e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"flex flex-col gap-3 mb-4",children:e.jsx("div",{className:"flex flex-col gap-2 ",children:e.jsx(w,{onChange:u=>n.setData("status",u),label:"Status",placeholder:"Select status...",items:J,value:n.data.status})})}),e.jsx(b,{onClick:()=>{s()},children:"Update"})]})}export{se as default};
