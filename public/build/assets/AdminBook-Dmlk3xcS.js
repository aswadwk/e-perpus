import{r as i,W as w,y as P,j as e,Y as E,a as g}from"./app-C6SFS50B.js";import{T as R,a as H,b as u,D as L}from"./tabs-k7lupySL.js";import{I as O}from"./InputCheckBox-CA9P94dH.js";import{I as M}from"./InputCustom-VAyEb9vp.js";import{D as V}from"./DefaultLayout-D_s0XWYt.js";import{P as Y,T as J,a as U,b as q}from"./PaginateDemo-Bb-wmWNm.js";import{S as z}from"./Sheet-DRzjVnfL.js";import{B as o,i as G}from"./button-CCvBVxMY.js";import{C as y,a as N,b as S,c as D,d as T}from"./card-8IVMwDKs.js";import{I as W}from"./input-CdbUr0YJ.js";import{L as K}from"./label-XivaCM4i.js";import{l as Q,T as X,a as Z,b as v,c as n,d as $,e as l}from"./lodash-CYSXlcM6.js";import{r as k,t as B,d as ee,a as se}from"./utils-qQ2OrSDw.js";import{J as C}from"./index-Cyr5XEdt.js";import{S as re}from"./square-pen-Y7AOPflN.js";import"./calendar-DqUkXWJs.js";import"./popover-DvVeSpeR.js";import"./index-ydiVDJ0R.js";import"./index-BgJgPHWB.js";import"./checkbox-Cv-nouFf.js";import"./ThemeProvider-BIHxQ64F.js";const Se=({books:a})=>{var m;const[r,t]=i.useState({per_page:10,search:"",with_trashed:!1}),[c,h]=i.useState({borrowBook:!1});i.useState({});const d=w({book_id:"",return_date:new Date,notes:"",fine:!0}),{delete:_}=w({}),j=i.useRef(!0),b=i.useRef(Q.debounce(s=>{let x=k({...s,start_date:B(s.start_date,""),end_date:B(s.end_date,"")});P.get(route("web.books.admin"),{...x},{preserveState:!0,preserveScroll:"errors"})},500)).current;i.useEffect(()=>{if(j.current){j.current=!1;return}b(r)},[r]);function I(){return r.search||r.with_trashed}function A(s){confirm("Are you sure you want to delete this book?")&&_(route("web.books.destroy",s))}async function F(){d.post(route("web.books.borrow",d.data.book_id),{preserveState:!0,onSuccess:()=>{d.reset(),C.success("Book borrowed successfully"),h({...c,borrowBook:!1})},onError:()=>{C.error("Failed to borrow book")}})}return e.jsxs(V,{children:[e.jsx(E,{title:"Books"}),e.jsx(z,{isOpen:c.borrowBook,onClose:()=>{h({...c,borrowBook:!1})},width:"w-[600px] sm:w-[840px]",title:"Borrow Book",description:"Fill in the form below to borrow a book",children:e.jsx(te,{form:d,onSubmit:F})}),e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(S,{children:"Buku"})}),e.jsxs(D,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(R,{className:"hidden sm:flex",defaultValue:"all",value:r.subscription,onValueChange:s=>{t({...r,subscription:s})},children:e.jsxs(H,{children:[e.jsx(u,{value:"",children:"All"}),e.jsx(u,{value:"available",children:"In Stock"}),e.jsx(u,{value:"unavailable",children:"Out of Stock"})]})})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[I()&&e.jsx(o,{variant:"outline",onClick:()=>{t({...r,search:"",per_page:"",with_trashed:!1})},children:"Clear Filter"}),e.jsx(W,{placeholder:"Search ",onChange:s=>{t({...r,search:s.target.value})},className:"w-[150px] lg:w-[250px]",value:r.search}),e.jsx(g,{href:route("web.books.create"),children:e.jsxs(o,{children:[e.jsx(Y,{}),"Tambah Buku"]})})]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto border rounded-lg",children:e.jsxs(X,{children:[e.jsx(Z,{children:e.jsxs(v,{children:[e.jsx(n,{}),e.jsx(n,{children:"Title"}),e.jsx(n,{children:"Author"}),e.jsx(n,{children:"Category"}),e.jsx(n,{children:"ISBN"}),e.jsx(n,{children:"Stock"}),e.jsx(n,{children:"Created At"}),e.jsx(n,{className:"text-center",children:"Action"})]})}),e.jsx($,{children:(m=a==null?void 0:a.data)==null?void 0:m.map(s=>{var x,f,p;return e.jsxs(v,{children:[e.jsx(l,{children:e.jsx("img",{src:G(s==null?void 0:s.cover),alt:s==null?void 0:s.title})}),e.jsxs(l,{children:[(s==null?void 0:s.title)??"Unknown",e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground",children:(x=s==null?void 0:s.category)==null?void 0:x.name})]}),e.jsx(l,{children:s.author}),e.jsxs(l,{children:[(f=s==null?void 0:s.category)==null?void 0:f.name,e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground",children:(p=s==null?void 0:s.category)==null?void 0:p.code})]}),e.jsx(l,{children:s.isbn}),e.jsx(l,{children:s.stock}),e.jsxs(l,{className:"text-nowrap",children:[ee(s.created_at),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground",children:se(s.created_at)})]}),e.jsx(l,{children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(o,{variant:"ghost",children:e.jsx(g,{href:route("web.books.edit",s.id),children:e.jsx(re,{height:18})})}),e.jsx(o,{variant:"ghost",onClick:()=>{A(s.id)},children:e.jsx(J,{height:18})}),e.jsx(o,{variant:"ghost",onClick:()=>{d.setData("book_id",s.id),h({...c,borrowBook:!0})},children:"Borrow"})]})})]},s.id)})})]})})]}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(U,{from:a.from,to:a.to,total:a.total}),e.jsx("div",{children:e.jsx(q,{links:a.links})})]})})]})]})};function te({onSubmit:a,form:r}){return console.log("form"),console.log(r),e.jsx("div",{children:e.jsxs(y,{className:"mt-4 border-none",children:[e.jsx(N,{children:e.jsx(S,{children:"Book Details"})}),e.jsx(D,{children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsx(K,{htmlFor:"book",children:"Return Date"}),e.jsx(L,{onChange:t=>{r.setData("return_date",t)},value:r.data.return_date})]}),e.jsx("div",{children:e.jsx(M,{error:r.errors.notes,type:"text",onChange:t=>{r.setData("notes",t.target.value)},label:"Notes",value:r.data.notes,placeholder:"Notes"})}),e.jsx("div",{children:e.jsx(O,{error:r.errors.fine,label:"Book Condition Good",onChange:t=>{r.setData("fine",t)},placeholder:"Fine",value:r.data.fine,id:"bookCondition"})})]})}),e.jsx(T,{children:e.jsx("div",{className:"flex justify-end",children:e.jsx(o,{onClick:t=>{t.preventDefault(),a()},children:"Borrow"})})})]})})}export{Se as default};
