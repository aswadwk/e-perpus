import{r as l,W as p,j as e,Y as g}from"./app-DzYUMRS6.js";import{D as S}from"./DefaultLayout-DcBmND8z.js";import{S as w}from"./SelectInput-LvUN8H4p.js";import{S as D}from"./Sheet-B-f9L1CM.js";import{B as b}from"./button-DaOaNqDk.js";import{C as B,a as _,b as C,e as v,c as T}from"./card-B7KI1K_u.js";import{l as y,T as H,a as E,b as h,c as r,d as N,e as o}from"./lodash-BAtCn9Gs.js";import{r as P,t as x,d as R,a as U}from"./utils-C_xD1QX0.js";import{J as j}from"./index-Aw_-t0DS.js";import{S as M}from"./square-pen-DzvLqRc9.js";import"./index-DBEPlhEX.js";import"./index-Ci1HpHrc.js";import"./dialog-DIH4NhBM.js";import"./popover-D4eaLzvs.js";import"./label-C7lilHTh.js";function A(s){switch(s){case"pending":return"Menunggu";case"borrowed":return"Dipinjam";case"returned":return"Dikembalikan";case"rejected":return"Ditolak";default:return s}}const ae=({histories:s})=>{var m;const[n,u]=l.useState({per_page:10,start_date:"",end_date:"",search:"",subscription:"",with_trashed:!1}),[i,d]=l.useState({borrowBook:!1}),t=p({status:"",id:"",return_date_actual:""});p({});const c=l.useRef(!0),f=l.useRef(y.debounce(a=>{P({...a,start_date:x(a.start_date,""),end_date:x(a.end_date,"")})},500)).current;l.useEffect(()=>{if(c.current){c.current=!1;return}f(n)},[n]);async function k(){console.log(t.data),t.post(route("web.histories.update",t.data.id),{preserveState:!0,onSuccess:()=>{t.reset(),j.success("Book status updated successfully"),d({...i,borrowBook:!1})},onError:()=>{j.error("Failed to update book status")}})}return e.jsxs(S,{children:[e.jsx(g,{title:"Publisher"}),e.jsx(D,{isOpen:i.borrowBook,onClose:()=>{d({...i,borrowBook:!1})},width:"w-[600px] sm:w-[840px]",title:"Ubah Status Peminjaman Buku",description:"Ubah status peminjaman buku",children:e.jsx(O,{form:t,onSubmit:k})}),e.jsxs(B,{className:"w-full mx-auto",children:[e.jsxs(_,{children:[e.jsx(C,{children:"Histori Peminjaman Buku"}),e.jsx(v,{children:"Daftar pemijaman buku yang pernah dilakukan oleh pengguna"})]}),e.jsx(T,{children:e.jsxs(H,{children:[e.jsx(E,{children:e.jsxs(h,{children:[e.jsx(r,{children:"Judul"}),e.jsx(r,{children:"Author"}),e.jsx(r,{children:"Tanggal Pinjam"}),e.jsx(r,{children:"Tanggal Balik"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Aksi"})]})}),e.jsx(N,{children:(m=s.data)==null?void 0:m.map(a=>e.jsxs(h,{children:[e.jsx(o,{className:"font-medium",children:a.book.title}),e.jsx(o,{children:a.book.author}),e.jsxs(o,{children:[R(a.created_at),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-500",children:U(a.created_at)})]}),e.jsx(o,{children:a.return_date}),e.jsx(o,{children:A(a.status)}),e.jsx(o,{children:e.jsx(b,{variant:"ghost",onClick:()=>{t.setData("id",a.id),d({...i,borrowBook:!0})},children:e.jsx(M,{size:16})})})]},a.id))})]})})]})]})},J=[{value:"pending",label:"Pending"},{value:"borrowed",label:"Dipinjam"},{value:"returned",label:"Dikembalikan"},{value:"rejected",label:"Ditolak"}];function O({onSubmit:s,form:n}){return e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"flex flex-col gap-3 mb-4",children:e.jsx("div",{className:"flex flex-col gap-2 ",children:e.jsx(w,{onChange:u=>n.setData("status",u),label:"Status",placeholder:"Select status...",items:J,value:n.data.status})})}),e.jsx(b,{onClick:()=>{s()},children:"Update"})]})}export{ae as default};
