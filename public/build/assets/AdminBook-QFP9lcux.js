import{r as l,W as f,j as e,Y as F,a as v}from"./app-mwD8rKH0.js";import{D as P}from"./DatePicker-C7vu7-LY.js";import{I as E}from"./InputCheckBox-Wmx2TLOv.js";import{I as R}from"./InputCustom-CP7xuHEb.js";import{D as H}from"./DefaultLayout-y9en6JwO.js";import{P as L,a as O,b as M}from"./PaginateDemo-lzxoqZ7H.js";import{S as V}from"./Sheet-BDsnv9r-.js";import{B as d}from"./button-DM4OJObE.js";import{C,a as b,b as _,c as y,d as N}from"./card-CsNZX89Y.js";import{I as Y}from"./input-CvVn_6Ux.js";import{L as J}from"./label-D-VhJ438.js";import"./sheet-DRZm5MKN.js";import{l as U,T as q,a as z,b as w,c as i,d as G,e as n,S as W}from"./lodash-MX0gHBgf.js";import{T as k,a as K,b as x}from"./tabs-B611ChrD.js";import{r as Q,t as g,d as X,a as Z}from"./utils-BmcsHCy2.js";import{J as B}from"./index-COBK1RFK.js";import{T as $}from"./trash-XrOtvgL_.js";import"./calendar-BrTrmFed.js";import"./popover-Cc93Q8JV.js";import"./index-BwAztNm9.js";import"./checkbox-qXoUKGSx.js";import"./eye-3OV7WLb8.js";import"./index-D_-WwNEz.js";const _e=({books:a})=>{var j;const[r,t]=l.useState({per_page:10,start_date:"",end_date:"",search:"",subscription:"",with_trashed:!1}),[c,h]=l.useState({borrowBook:!1});l.useState({});const o=f({book_id:"",return_date:new Date,notes:"",fine:!0}),{delete:D}=f({}),u=l.useRef(!0),S=l.useRef(U.debounce(s=>{Q({...s,start_date:g(s.start_date,""),end_date:g(s.end_date,"")})},500)).current;l.useEffect(()=>{if(u.current){u.current=!1;return}S(r)},[r]);function T(){return r.search||r.start_date||r.end_date||r.subscription||r.with_trashed}function I(s){confirm("Are you sure you want to delete this publisher?")&&D(route("web.publishers.destroy",s))}async function A(){o.post(route("web.books.borrow",o.data.book_id),{preserveState:!0,onSuccess:()=>{o.reset(),B.success("Book borrowed successfully"),h({...c,borrowBook:!1})},onError:()=>{B.error("Failed to borrow book")}})}return e.jsxs(H,{children:[e.jsx(F,{title:"Books"}),e.jsx(V,{isOpen:c.borrowBook,onClose:()=>{h({...c,borrowBook:!1})},width:"w-[600px] sm:w-[840px]",title:"Borrow Book",description:"Fill in the form below to borrow a book",children:e.jsx(ee,{form:o,onSubmit:A})}),e.jsxs(C,{children:[e.jsx(b,{children:e.jsx(_,{children:"Books"})}),e.jsxs(y,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(k,{className:"hidden sm:flex",defaultValue:"all",value:r.subscription,onValueChange:s=>{t({...r,subscription:s})},children:e.jsxs(K,{children:[e.jsx(x,{value:"",children:"All"}),e.jsx(x,{value:"available",children:"In Stock"}),e.jsx(x,{value:"unavailable",children:"Out of Stock"})]})})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[T()&&e.jsx(d,{variant:"destructive",onClick:()=>{t({...r,search:"",start_date:"",end_date:"",subscription:"",per_page:"",with_trashed:!1})},children:"Clear Filter"}),e.jsx(Y,{placeholder:"Search ",onChange:s=>{t({...r,search:s.target.value})},className:"w-[150px] lg:w-[250px]",value:r.search}),e.jsx(v,{href:route("web.books.create"),children:e.jsxs(d,{children:[e.jsx(L,{}),"Add Books"]})})]})]}),e.jsx("div",{className:"mt-4 overflow-x-auto border rounded-lg",children:e.jsxs(q,{children:[e.jsx(z,{children:e.jsxs(w,{children:[e.jsx(i,{children:"Title"}),e.jsx(i,{children:"Author"}),e.jsx(i,{children:"Category"}),e.jsx(i,{children:"ISBN"}),e.jsx(i,{children:"Stock"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Created At"}),e.jsx(i,{className:"text-center",children:"Action"})]})}),e.jsx(G,{children:(j=a==null?void 0:a.data)==null?void 0:j.map(s=>{var m,p;return e.jsxs(w,{children:[e.jsx(n,{children:e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{children:[s==null?void 0:s.id,(s==null?void 0:s.title)??"Unknown"]})})}),e.jsx(n,{children:s.author}),e.jsxs(n,{children:[(m=s==null?void 0:s.category)==null?void 0:m.name,e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground",children:(p=s==null?void 0:s.category)==null?void 0:p.code})]}),e.jsx(n,{children:s.isbn}),e.jsx(n,{children:s.stock}),e.jsx(n,{children:s.status}),e.jsxs(n,{className:"text-nowrap",children:[X(s.created_at),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Z(s.created_at)})]}),e.jsx(n,{children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(d,{variant:"ghost",children:e.jsx(v,{href:route("web.publishers.edit",s.id),children:e.jsx(W,{height:18})})}),e.jsx(d,{variant:"ghost",onClick:()=>{I(s.id)},children:e.jsx($,{height:18})}),e.jsx(d,{variant:"ghost",onClick:()=>{o.setData("book_id",s.id),h({...c,borrowBook:!0})},children:"Borrow"})]})})]},s.id)})})]})})]}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(O,{from:a.from,to:a.to,total:a.total}),e.jsx("div",{children:e.jsx(M,{links:a.links})})]})})]})]})};function ee({onSubmit:a,form:r}){return console.log("form"),console.log(r),e.jsx("div",{children:e.jsxs(C,{className:"mt-4 border-none",children:[e.jsx(b,{children:e.jsx(_,{children:"Book Details"})}),e.jsx(y,{children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsx(J,{htmlFor:"book",children:"Return Date"}),e.jsx(P,{onChange:t=>{r.setData("return_date",t)},value:r.data.return_date})]}),e.jsx("div",{children:e.jsx(R,{error:r.errors.notes,type:"text",onChange:t=>{r.setData("notes",t.target.value)},label:"Notes",value:r.data.notes,placeholder:"Notes"})}),e.jsx("div",{children:e.jsx(E,{error:r.errors.fine,label:"Book Condition Good",onChange:t=>{r.setData("fine",t)},placeholder:"Fine",value:r.data.fine,id:"bookCondition"})})]})}),e.jsx(N,{children:e.jsx("div",{className:"flex justify-end",children:e.jsx(d,{onClick:t=>{t.preventDefault(),a()},children:"Borrow"})})})]})})}export{_e as default};
